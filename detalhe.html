<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Editar Notebook</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <a href="lista.html">⬅ Voltar à lista</a>
  <h1>Editar Notebook</h1>

  <form id="formEdicao">
    <label for="nome">Nome:</label>
    <input type="text" id="nome" name="nome" required />

    <label for="marca">Marca:</label>
    <input type="text" id="marca" name="marca" />

    <label for="processador">Processador:</label>
    <input type="text" id="processador" name="processador" />

    <label for="ram">RAM:</label>
    <input type="text" id="ram" name="ram" />

    <button type="submit">Salvar Alterações</button>
  </form>

  <script>
    const id = new URLSearchParams(location.search).get("id");
    const form = document.getElementById("formEdicao");
    const inputNome = document.getElementById("nome");
    const inputMarca = document.getElementById("marca");
    const inputProcessador = document.getElementById("processador");
    const inputRAM = document.getElementById("ram");

    if (!id) {
      alert("Nenhum ID informado!");
      location.href = "lista.html";
    }

    fetch(`https://api.restful-api.dev/objects/${id}`)
      .then(res => res.json())
      .then(item => {
        inputNome.value = item.name || "";
        inputMarca.value = item.data?.marca || "";
        inputProcessador.value = item.data?.processador || "";
        inputRAM.value = item.data?.ram || "";
      })
      .catch(err => {
        console.error(err);
        alert("Erro ao carregar os dados.");
      });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const dadosAtualizados = {
        name: inputNome.value.trim(),
        data: {
          marca: inputMarca.value.trim(),
          processador: inputProcessador.value.trim(),
          ram: inputRAM.value.trim()
        }
      };

      try {
        const response = await fetch(`https://api.restful-api.dev/objects/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(dadosAtualizados)
        });

        if (!response.ok) throw new Error("Falha ao atualizar.");

        alert("Item atualizado com sucesso!");
        window.location.href = "lista.html";
      } catch (err) {
        console.error(err);
        alert("Erro ao atualizar o item.");
      }
    });
  </script>

</body>
</html>
